{# ===================================================================== #}
{#  Barra de navegaci√≥n principal - Accesibilidad WCAG 2.1 AA          #}
{# ===================================================================== #}
<nav class="navbar navbar-expand-lg navbar-light sticky-top" role="navigation" aria-label="Navegaci√≥n principal">
    <div class="container-fluid">
        {# Logo con alt descriptivo #}
        <a class="navbar-brand logo-economik0" href="/" aria-label="Economik0 - Ir a inicio">
            <img src="{{ asset('img/Economik0_icon.png') }}" alt="Logo de Economik0" width="40" height="40" class="me-2">
            <span aria-hidden="true">Economik<span class="zero-color">0</span></span>
        </a>
        
        {# Bot√≥n hamburguesa accesible #}
        <button class="navbar-toggler collapsed" 
                type="button" 
                data-bs-toggle="collapse" 
                data-bs-target="#navbarNav" 
                aria-controls="navbarNav" 
                aria-expanded="false" 
                aria-label="Abrir men√∫ de navegaci√≥n">
            <span class="toggler-icon top-bar" aria-hidden="true"></span>
            <span class="toggler-icon middle-bar" aria-hidden="true"></span>
            <span class="toggler-icon bottom-bar" aria-hidden="true"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto align-items-center" role="menubar">
                <li class="nav-item" role="none">
                    <a class="nav-link px-3" href="{{ path('about') }}" role="menuitem">
                        Qui√©nes Somos
                    </a>
                </li>

                {% if app.user %}
                    {# ========== USUARIO AUTENTICADO ========== #}
                    
                    {% if is_granted('ROLE_PROVEEDOR') %}
                        {# ----- PROVEEDOR ----- #}
                        <li class="nav-item" role="none">
                            <a class="nav-link px-3" href="{{ path('app_admin_productos') }}" role="menuitem">
                                <span aria-hidden="true">üì¶</span>
                                <span class="nav-text">Mi Inventario</span>
                            </a>
                        </li>
                        <li class="nav-item" role="none">
                            <a class="btn btn-register ms-lg-3" href="{{ path('app_admin_producto_nuevo') }}" role="menuitem">
                                <span aria-hidden="true">+</span> A√±adir Producto
                            </a>
                        </li>
                    {% else %}
                        {# ----- CLIENTE (ROLE_USER) ----- #}
                        <li class="nav-item" role="none">
                            <a class="nav-link px-3" href="{{ path('app_tienda') }}" role="menuitem">
                                <span aria-hidden="true">üõçÔ∏è</span>
                                <span class="nav-text">Tienda</span>
                            </a>
                        </li>
                        <li class="nav-item" role="none">
                            {% set cartCount = app.session.get('cart')|default({})|reduce((carry, v) => carry + v, 0) %}
                            <a class="nav-link px-3 cart-link" 
                               href="{{ path('app_cart') }}" 
                               role="menuitem"
                               aria-label="Carrito de compras{% if cartCount > 0 %}, {{ cartCount }} art√≠culo{% if cartCount > 1 %}s{% endif %}{% endif %}">
                                <span aria-hidden="true">üõí</span>
                                <span class="nav-text">Carrito</span>
                                {% if cartCount > 0 %}
                                    <span class="cart-badge" aria-hidden="true">{{ cartCount }}</span>
                                {% endif %}
                            </a>
                        </li>
                    {% endif %}

                    {# Com√∫n para todos los usuarios autenticados #}
                    <li class="nav-item" role="none">
                        <a class="nav-link px-3 logout-link" 
                           href="{{ path('app_logout') }}" 
                           role="menuitem"
                           aria-label="Cerrar sesi√≥n de {{ app.user.email }}">
                            Cerrar Sesi√≥n
                        </a>
                    </li>

                {% else %}
                    {# ========== USUARIO AN√ìNIMO ========== #}
                    <li class="nav-item" role="none">
                        <a class="nav-link px-3" href="{{ path('app_proveedor') }}" role="menuitem">
                            Soy Proveedor
                        </a>
                    </li>
                    <li class="nav-item" role="none">
                        <a class="nav-link px-3" href="{{ path('app_login') }}" role="menuitem">
                            Iniciar Sesi√≥n
                        </a>
                    </li>
                    <li class="nav-item" role="none">
                        <a class="btn btn-register ms-lg-3" href="{{ path('app_register') }}" role="menuitem">
                            Registro
                        </a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>
